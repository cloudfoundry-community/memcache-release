---
pidfile: /var/vcap/sys/run/memcache_hazelcast/memcache_hazelcast.pid

logging:
  level: INFO

nats:
  machines:
<% p("nats.machines").each do |address| %>
  - nats://<%= p("nats.user") %>:<%= p("nats.password") %>@<%= address %>:<%= p("nats.port") %>
<% end %>


host:
  local: <%= spec.networks.send(properties.networks.apps).ip %>
  public: memcache-hazelcast.<%= p('domain')%>
  port: <%= p('memcache_hazelcast.host.port') %>
  username: <%= p('memcache_hazelcast.host.username') %>
  password: <%= p('memcache_hazelcast.host.password') %>

tomcat:
  base_directory: /var/vcap/sys/run/memcache_hazelcast/tomcat
  
memcache:
  port: <%= p('memcache_hazelcast.memcache.port') %>
  secret_key: <%= p('memcache_hazelcast.memcache.secret_key') %>

hazelcast:
  executor_pool_size: <%= p('memcache_hazelcast.hazelcast.executor_pool_size') %>
  local_member_safe_timeout: <%= p('memcache_hazelcast.hazelcast.local_member_safe_timeout') %>
  max_cache_size: <%= p('memcache_hazelcast.hazelcast.max_cache_size') %>
  minimum_cluster_members: <%= p('memcache_hazelcast.hazelcast.minimum_cluster_members') %>
  percent_to_trim: <%= p('memcache_hazelcast.hazelcast.percent_to_trim') %>
  port: <%= p('memcache_hazelcast.hazelcast.port') %>
  trim_delay: <%= p('memcache_hazelcast.hazelcast.trim_delay') %>
  partition_count: <%= p('memcache_hazelcast.hazelcast.partition_count') %>
  io_thread_count: <%= p('memcache_hazelcast.hazelcast.io_thread_count') %>
  operation_thread_count: <%= p('memcache_hazelcast.hazelcast.operation_thread_count') %>
  operation_generic_thread_count: <%= p('memcache_hazelcast.hazelcast.operation_generic_thread_count') %>
  event_thread_count: <%= p('memcache_hazelcast.hazelcast.event_thread_count') %>
  client_event_thread_count: <%= p('memcache_hazelcast.hazelcast.client_event_thread_count') %>
  max_no_heartbeat_seconds: 100000
<% if_p("memcache_hazelcast.hazelcast.machines") do |zones| %>
  machines:
<% zones.each do |zone, machines| %>
    <%= zone %>:
  <% machines.each do |machine| %>
    - <%= machine %>
  <% end %>
<% end %>
<% end %>

<% if_p("memcache_hazelcast.plans") do |plans| %>
plans:
<% plans.each do |plan_name, plan| %>
  <%= plan_name %>:
  <% plan.each do |plan_key, plan_value| %>
    <% if plan_key == "near_cache" %>
    near_cache:
    <% plan_value.each do |near_key, near_value| %>
      <%= near_key %>: <%= near_value %>
    <% end %>
    <% else %>
    <%= plan_key %>: <%= plan_value %>
    <% end %>
  <% end %>
<% end %>
<% end %>
